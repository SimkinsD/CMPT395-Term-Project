{% extends 'base.html' %}


{% block title %}
  <title>Caraway Calendar</title>
{% endblock title %}

{% block add_css %}
  {% load static %}
  <script src="{% static 'js/calendar.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'css/calendar.css' %}" />
{% endblock add_css %}


{% block content %}
  <!-- Classroom list -->
  <section id="js-class-list">
    {% for class_name in view.CLASSROOMS %}
      <!--
        Resulting css class will be class-name-nameofclassroom;
        i.e. class-name-Red
      -->
      <i onclick="switch_calendar('{{ class_name }}')">
        <section id="class-name-{{ class_name }}" class="class-selector">
          {{ class_name }}
        </section>
      </i>
    {% endfor %}  
  </section>

  <div id="sign-up-overlay">
    <div id="sign-up-popup">
      <div id="sign-up-popup-close">
        <i class="fa fa-times-circle" onclick="toggle_popup('sign-up-overlay')"></i>
        <div class="clear"></div>
      </div>
      
      <section id="signup_headers">
        <h3 id="js-signup-day" class="signup-title">Default</h5>
        <h5 id="js-signup-date" class="signup-title">Default</h5>
      </section>
      
      <form id="signup_form" method="post">
        {% csrf_token %}
        <fieldset>
          <legend>Sign-up Information:</legend>
          {{ view.signup_form.as_p }}
          <input id="js-signup-hidden-date" type="hidden" name="day" value="Default"/>
          <button type="submit">Submit</button>
        </fieldset>
      </form>
    </div> <!-- End sign-up-form -->
  </div> <!-- End sign-up-overlay -->
  
  <!-- Calendar -->
  {% load calendar_tags %}
  {% for class in view.CLASSROOMS %}
    <section id="js-{{ class }}-calendar" class="calendar">
    {% for day in view.date_and_name %}
      <section class="day">
        <section class="day-header">
          <h3>{{ day.0 }}</h3>
          <h3>{{ day.1 }}</h3>
        </section>
        {% for slot in view.TIME_SLOTS %}
          <section class="time-slot">
           <h3>{{ slot.title }} <span class="fa fa-plus-circle" onclick="toggle_signup('{{ day.0 }}', '{{ day.1 }}', '{% format_time slot.start %}', '{% format_time slot.end %}', '{% format_date day.1 %}')"></span></h3>
           <h4>{{ slot.start }} - {{ slot.end }}</h4>
             {% for signup in view.signup_objects %}
               {% if signup.classroom == class %}
                 {% if signup.date == day.1 %}
                   {% if signup.start_time >= slot.start and signup.end_time <= slot.end %}
                     <section class="event">
                       <p class="signup-info">{{ signup.volunteer }}</p>
                       <p class="signup-info">{% format_time signup.start_time %} - {% format_time signup.end_time %}</p>
                     </section><!-- End event -->
                   {% endif %}
                 {% endif %}
               {% endif %}
             {% endfor %}
          </section> <!-- End time-slot -->
        {% endfor %}
      </section> <!-- End day -->
    {% endfor %}
    </section> <!-- End calendar -->
    {% empty %}
      <h3>List Empty</h3>
  {% endfor %}
{% endblock content %}
